import os
import tkinter as tkinter
import subprocess


class Window:
    def __init__(self):
        self.root = tkinter.Tk()
        self.root.title("Malware Analysis")
        self.root.geometry('500x500')
        self.root.resizable(0,0)
        self.path = os.path.dirname(os.path.abspath(__file__))
        pass

    def ParseCommand(self):
        # Get the name of the malware and call batch file and wait
        self.label.config(text="Processing...")
        self.label.update()

        malwarename = self.textbox.get()
        batchfilepath = os.path.join(str(self.path), "MalwareFamilyAnalysis.bat")
        runcommand = batchfilepath + " " + malwarename
        print(runcommand)

        batchprocess = subprocess.call(runcommand)

        #Wait for the subprocess to finish
        #Open a new window and display the result
        self.label.config(text="Processing Done")


        pass

    def AddLabel(self, text):
        self.label = tkinter.Label(self.root, text=text)
        self.label.pack()
        pass

    def AddButton(self, name, command):
        self.parseButton = tkinter.Button(self.root, text=name, command=command)
        self.parseButton.pack()
        pass

    def AddEditText(self):
        self.textbox = tkinter.Entry(self.root)
        self.textbox.pack()

    def MainLoop(self):
        self.root.mainloop()


def main():
    gui = Window()
    gui.AddLabel("Enter the name of Malware..!!")
    gui.AddEditText()
    parseCommand = gui.ParseCommand
    gui.AddButton("Parse", parseCommand)
    gui.MainLoop()


if __name__ == "__main__":
    main()
